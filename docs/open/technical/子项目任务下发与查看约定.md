# 子项目任务下发与查看约定

**目的**：约定主仓/规划向子项目下发**开发待办**（需求、Issue、Story）时，子项目在 **repo/文件** 中去哪里查看。  
**范围**：仅规划侧（ISSUE_LIST、_bmad-output、主仓 planning-artifacts）。运行态「要做的内容」从哪里拿见天枢 `tianshu/docs/任务与消费-实现状态.md` 与根仓 `子项目任务消费快速参考.md`（当前平台约定：仅 Matrix 收消息及既有投递接口）。

---

## 1. 子项目视角：主仓与规划产出位置

子项目可能在**主仓内**或**独立环境**中执行，需能解析「待办从哪里来」：

- **主仓**：紫微主仓（ziwei），即本约定的发布方与规划产出所在仓库。
- **根仓 / 规划产出位置**：
  - 若当前工作区**包含主仓且本子项目在主仓下**（例如路径为 `ziwei/tianshu`）：根仓 = 主仓的仓库根目录（相对本子项目通常为上一级 `..` 或工作区根）。
  - 若子项目在**独立环境**中执行（单独克隆、无主仓目录）：无「主仓」概念，待办与规划清单从**可访问的规划产出位置**获取，该位置由本子项目或环境约定（如 README、配置中的 `ZIWEI_ROOT` 或 planning-artifacts 路径/URL）。

下文中「根仓」均指：上述根仓，或独立环境下配置的规划产出目录。

---

## 2. 任务下发（规划侧）

主仓或规划把「要子项目完成的开发工作」（需求、Issue、Story）写在 repo/文件中，子项目到下面「去哪里查」的位置看。

---

## 3. 去哪里查

子项目在以下位置查看下发给自己的待办：

- 本子项目的 **ISSUE_LIST.md**（或等价需求清单）
- 本子项目的 **_bmad-output/**（Epic、Story、实现就绪等）
- 根仓 **docs/open/technical/**、**_bmad-output/planning-artifacts/** 中引用或映射到该子项目的规划、Epic、待办

---

## 4. 子项目查找规划待办的推荐顺序

执行「有没有开发待办」或「规划待办从哪里来」时（仅限 repo/文件，不涉及天枢 API），可按以下顺序汇总：

1. **本子项目**：读本目录 **agent.md**；按需 glob 本目录 `**/ISSUE*`、`**/*todo*`、`**/_bmad*`。
2. **根仓**：glob 根仓 `**/ISSUE*`、`**/_bmad-output/**`，定位引用到本子项目的条目。
3. **主仓规划执行清单**：读根仓 **_bmad-output/planning-artifacts/** 下的主清单与同步文档，筛出与本子项目相关的待办，例如：
   - `下一步执行清单.md`
   - `各子项目应对焦事项与进度同步.md`
   - `操作路径-下一步怎么执行.md`

若本子项目下暂无 ISSUE_LIST 或 _bmad-output，以主仓 planning-artifacts 中与该子项目相关的结论为准。

---

## 5. 引用

- 任务归属与调度、BMAD 角色与工作流：`子项目任务与Agent调度约定.md`
- 运行态「要做的内容」如何拿（当前：Matrix 收消息及既有投递）：天枢 `tianshu/docs/任务与消费-实现状态.md`，根仓 `子项目任务消费快速参考.md`
