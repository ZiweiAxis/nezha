# 紫微跨子项目文档方案 — 通用约定

**版本**：v1.0  
**日期**：2026-02-13  
**角色**：PM（BMAD）— 根目录统一规划视角  
**目的**：在根目录已安装 BMAD 的前提下，约定「子项目相关文档」的归属、命名与引用关系，供紫微（ziwei）及天枢、谛听等子项目统一遵循。

---

## 1. 当前子项目文档分布（分析结论）

### 1.1 根目录（ziwei/）

| 位置 | 内容 | 用途 |
|------|------|------|
| `ziwei/docs/open/technical/` | 紫微智能体治理基础设施-技术方案.md、架构图.drawio、BMAD-多子项目管理-最佳实践.md | **跨子项目**权威：总体架构、BMAD 多项目实践 |
| `ziwei/_bmad-output/` | planning-artifacts、implementation-artifacts（初装为空） | **根目录 BMAD** 产出：总体 PRD/架构/Epics（待创建） |

### 1.2 谛听（diting/）

| 位置 | 内容 | 用途 |
|------|------|------|
| `diting/docs/` | STRUCTURE.md、DEVELOPMENT.md、COMMIT_GUIDANCE.md、部署/测试/交付等 | 开发规范、部署、交付；**长期维护的稳定文档** |
| `diting/_bmad-output/planning-artifacts/` | prd.md、architecture.md、epics.md、pm-what-to-do-next.md、implementation-readiness 等 | **谛听本地 BMAD** 规划与状态 |
| `diting/ISSUE_LIST.md` | 需求/缺陷/扩展列表（含跨子项如天枢对接） | 与实现和跨子项目依赖对齐 |

### 1.3 天枢（tianshu/）

| 位置 | 内容 | 用途 |
|------|------|------|
| `tianshu/docs/` | design-alignment-with-ziwei.md、deploy.md、agent-discovery.md 等 | 与主项目对齐说明、部署与设计；**长期维护** |
| `tianshu/_bmad-output/planning-artifacts/` | prd.md、architecture.md、epics-and-stories.md、next-stage.md 等 | **天枢本地 BMAD** 规划与状态 |

**结论**：子项目已有「各自 _bmad-output + 各自 docs」的清晰划分；根目录 docs 已承担跨子项目权威文档，根目录 _bmad-output 尚未有规划产物，适合作为「跨子项目统一规划」的落地点。

---

## 2. 通用约定：什么文档放哪里

### 2.1 根目录 ziwei/

- **`ziwei/docs/open/technical/`**（推荐版本控制）
  - **跨子项目、长期有效**：技术方案、架构图、BMAD 多子项目最佳实践、**本约定文档**。
  - 命名建议：`紫微-*.md` / `*-技术方案.md` / `BMAD-*.md`；架构图保持 `.drawio`。
  - 子项目在 PRD/架构/Epics 中**引用**这些文档的路径（如 `ziwei/docs/open/technical/紫微智能体治理基础设施-技术方案.md`），不复制为子项目本地权威副本。
- **`ziwei/_bmad-output/`**
  - **根目录 BMAD 工作流产出**：总体 PRD、总体 architecture（含 Integration、Standards and Conventions、ADR）、跨子项目 Epics/路线图、根级「下一步」类文档（如 pm-what-to-do-next.md）。
  - 子项目在本地规划时**引用**根目录 architecture 与 ADR，子项目本地 _bmad-output 只存**本子项目**的 PRD/架构/Epics 细化与实现状态。

### 2.2 子项目（diting、tianshu、未来太白等）

- **`<子项目>/docs/`**
  - 本子项目**稳定、长期维护**的文档：结构说明、开发/提交规范、部署、与主项目对齐说明（如 design-alignment-with-ziwei.md）、领域设计（如 agent-discovery、storage-backends）。
- **`<子项目>/_bmad-output/planning-artifacts/`**
  - 本子项目 BMAD 规划与状态：prd、architecture、epics、implementation-readiness、pm-what-to-do-next、next-stage 等；可含**子项目级 ADR** 或与根架构偏差分析（如 bmad-implementation-and-architecture-drift.md）。
- **子项目根目录**可选：`README.md`、`ISSUE_LIST.md`（若采用）等入口与清单。

### 2.3 引用关系（谁引用谁）

- **根 → 子**：根目录 PRD/architecture 可**指向**子项目（如「谛听负责策略与审计」「天枢负责通信与身份」），不替代子项目本地 PRD/架构。
- **子 → 根**：子项目 PRD、architecture、对齐文档**必须引用** `ziwei/docs/open/technical/紫微智能体治理基础设施-技术方案.md` 及（若存在）`ziwei/_bmad-output/planning-artifacts/architecture.md`；子项目 docs 中明确列出「对齐依据」表（参见 tianshu 的 design-alignment-with-ziwei.md）。
- **子 ↔ 子**：跨子项目接口与依赖（如天枢–谛听 DID/审批）在**根架构**或**双方 architecture** 中写清；具体任务/依赖可在子项目 ISSUE_LIST 或 Story 中注明（如 diting I-018）。

---

## 3. 命名与更新习惯

- **规划类**：`prd.md`、`architecture.md`、`epics.md`、`pm-what-to-do-next.md`、`next-stage.md` 等保持小写+连字符，与 BMAD 常见产出一致。
- **根目录规划**：若在根 _bmad-output 下新增，建议带前缀或子目录以区分「根级」与「子项目级」，例如根级可命名为 `prd-ziwei.md` 或置于 `planning-artifacts/root/`（可选，按团队习惯）。
- **更新时机**：技术方案/架构图有重大变更时，同步更新根 docs 并通知各子项目；子项目完成 Phase 3/4 里程碑后更新本子项目 planning-artifacts 与 docs 中的对齐说明。

---

## 4. 与 BMAD 工作流的对应

| BMAD 阶段 | 根目录（ziwei） | 子项目（diting/tianshu） |
|-----------|------------------|---------------------------|
| Phase 2 Planning | 总体 PRD 或产品简报 → `ziwei/_bmad-output/planning-artifacts/` | 子项目 PRD 引用根文档，存于 `*/_bmad-output/planning-artifacts/` |
| Phase 3 Solutioning | 总体 architecture（含 Integration、Standards、ADR）→ 根 _bmad-output | 子项目 architecture 引用根架构 + 本地 ADR/偏差分析 |
| Phase 4 Implementation | 根级「下一步」/路线图（可选） | 子项目 epics、stories、pm-what-to-do-next、ISSUE_LIST |

---

## 5. 小结

- **根目录**：`docs/` = 跨子项目权威文档；`_bmad-output/` = 根 BMAD 统一规划产出，供子项目引用。
- **子项目**：`docs/` = 本子项目稳定文档与对齐说明；`_bmad-output/planning-artifacts/` = 本子项目 BMAD 规划与状态。
- **一致性**：子项目在规划与实现前**优先阅读**根 `ziwei/docs/open/technical/` 及根 architecture（若有），并在子项目 docs 中显式列出「对齐依据」，避免与紫微总体架构偏离。

此约定与 `ziwei/docs/open/technical/BMAD-多子项目管理-最佳实践.md` 一致，可直接作为紫微跨子项目文档的通用处理方案使用。
